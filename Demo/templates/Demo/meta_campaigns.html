{% extends "Demo/base.html" %}

{% block title %} Meta Campaigns {% endblock title %}

{% block content %}
<div class="container py-4">
  <h2 class="mb-4">Meta Campaigns</h2>

  <div class="mb-3">
    <a href="{% url 'Demo:meta_select_ad_account' %}" class="btn btn-secondary btn-sm">Change Ad Account</a>
  </div>

  <!-- Filter Form -->
  <form method="get" class="mb-4">
  <div class="row">
    <div class="col-md-3">
      <label for="date_preset" class="form-label">Quick Date Range</label>
      <select id="date_preset" name="date_preset" class="form-select">
        <option value="today" {% if date_preset == "today" %}selected{% endif %}>Today</option>
        <option value="yesterday" {% if date_preset == "yesterday" %}selected{% endif %}>Yesterday</option>
        <option value="last_7d" {% if date_preset == "last_7d" %}selected{% endif %}>Last 7 Days</option>
        <option value="last_30d" {% if date_preset == "last_30d" %}selected{% endif %}>Last 30 Days</option>
        <option value="this_month" {% if date_preset == "this_month" %}selected{% endif %}>This Month</option>
        <option value="last_month" {% if date_preset == "last_month" %}selected{% endif %}>Last Month</option>
      </select>
    </div>
    <div class="col-md-3">
      <label for="start_date" class="form-label">Start Date</label>
      <input type="date" id="start_date" name="start_date" class="form-control" value="{{ start_date }}">
    </div>
    <div class="col-md-3">
      <label for="end_date" class="form-label">End Date</label>
      <input type="date" id="end_date" name="end_date" class="form-control" value="{{ end_date }}">
    </div>
    <div class="col-md-3">
      <label for="status" class="form-label">Campaign Status</label>
      <select id="status" name="status" class="form-select">
        <option value="ACTIVE" {% if status_filter == "ACTIVE" %}selected{% endif %}>Active</option>
        <option value="PAUSED" {% if status_filter == "PAUSED" %}selected{% endif %}>Paused</option>
        <option value="DELETED" {% if status_filter == "DELETED" %}selected{% endif %}>Deleted</option>
        <option value="ALL" {% if status_filter == "ALL" %}selected{% endif %}>All</option>
      </select>
    </div>
    <div class="col-md-3 d-flex align-items-end mt-3">
      <button type="submit" class="btn btn-primary w-100">Filter</button>
    </div>
  </div>
</form>


  {% if campaigns %}
  <div class="data-wrap">
    <div class="data-viewport">
      <div class="data-scroller" role="region" aria-label="Scrollable data table" tabindex="0">
        <table class="data-table" role="table" aria-label="Meta campaigns dataset">
          <thead>
            <tr>
              <th>Campaign ID</th>
              <th>Name</th>
              <th>Status</th>
              <th>Effective Status</th>
              <th>Daily Budget</th>
              <th>Budget Remaining</th>
              <th>Updated Time</th>
              <th>Spend</th>
              <th>Clicks</th>
              <th>Impressions</th>
              <th>Purchases Value</th>
              <th>ROAS</th>
            </tr>
          </thead>
          <tbody>
            {% for row in table_rows %}
            <tr>
              <td>{{ row.campaign_id }}</td>
              <td>{{ row.campaign_name }}</td>
              <td>{{ row.campaign_status }}</td>
              <td>{{ row.effective_status }}</td>
              <td>{{ row.daily_budget|intcomma }}</td>
              <td>{{ row.budget_remaining|intcomma }}</td>
              <td>{{ row.updated_time }}</td>
              <td>{{ row.spend|floatformat:2 }}</td>
              <td>{{ row.clicks }}</td>
              <td>{{ row.impressions }}</td>
              <td>{{ row.purchases_value|floatformat:2 }}</td>
              <td>{{ row.roas|floatformat:2 }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
  {% else %}
    <div class="alert alert-info">No campaigns found.</div>
  {% endif %}
</div>
{% endblock %}
